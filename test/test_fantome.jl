@testset "fantome" begin

    n = 10
    ϵ = 0.1

    rng = MersenneTwister(42)

    p = Squares(rng, n, ϵ)

    q = [[0.5       , 0.5       ],
         [0.20006862, 0.38139954],
         [0.32267135, 0.72687046],
         [0.68044674, 0.78095695],
         [0.77473372, 0.51989917],
         [0.4949439 , 0.23201753],
         [0.74204115, 0.28248482],
         [0.63101615, 0.3650337 ],
         [0.5846235 , 0.64552143],
         [0.45656816, 0.76644607]]
    
    v = [[ 0.,   1.] ,
         [ 1.,   0.] ,
         [-1.,   0.] ,
         [ 0.,  -1.] ,
         [ 1.,   0.] ,
         [ 0.,   1.] ,
         [ 0.,   1.] ,
         [-1.,   0.] ,
         [-1.,   0.] ,
         [ 0.,  -1.]]

    for i in 1:n
        p.q[i] = q[i]
        p.v[i] = v[i]
    end
    
    c = PeriodicCollisions( p )
    
    ref = [0 9 9 1 9 9 9 9 1 1;
           0 0 9 1 9 1 9 1 9 1;
           0 0 0 9 9 9 3 9 9 6;
           0 0 0 0 9 1 1 9 9 9;
           0 0 0 0 0 9 9 2 2 9;
           0 0 0 0 0 0 9 1 9 1;
           0 0 0 0 0 0 0 7 9 9;
           0 0 0 0 0 0 0 0 9 9;
           0 0 0 0 0 0 0 0 0 1;
           0 0 0 0 0 0 0 0 0 0]
    
    @test ref ≈ c.fantome

end

